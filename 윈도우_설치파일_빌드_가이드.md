# Windows 설치 파일 빌드 가이드

## 🎯 목표
RefBoard를 Windows 데스크톱 앱으로 빌드하여 `.exe` 설치 파일을 생성합니다.

---

## ✅ 사전 준비

### 1. 필요한 도구 확인

이미 설치되어 있어야 합니다:
- ✅ Node.js
- ✅ npm
- ✅ Electron Builder (이미 package.json에 포함됨)

### 2. 프로젝트 의존성 확인

```bash
cd D:\Scripts\RefBoard
npm install
```

---

## 🔨 빌드 단계

### 1단계: 프로덕션 빌드

먼저 React 앱을 빌드합니다:

```bash
cd D:\Scripts\RefBoard
npm run build
```

**결과:**
- `dist/` 폴더에 빌드된 파일이 생성됩니다
- TypeScript 컴파일 및 Vite 빌드가 실행됩니다

### 2단계: Electron 앱 패키징

Electron 앱을 Windows 설치 파일로 패키징합니다:

```bash
npm run electron:build
```

**또는 직접 실행:**

```bash
npm run build
electron-builder --win
```

**결과:**
- `release/` 폴더에 설치 파일이 생성됩니다
- 파일명: `RefBoard Setup 0.0.0.exe` (또는 유사한 이름)

---

## 📦 빌드 설정 확인

현재 `package.json`의 빌드 설정:

```json
{
  "build": {
    "appId": "com.refboard.app",
    "productName": "RefBoard",
    "directories": {
      "output": "release"
    },
    "files": [
      "dist/**/*",
      "electron/**/*"
    ],
    "win": {
      "target": "nsis"
    },
    "nsis": {
      "oneClick": false,
      "perMachine": false,
      "allowToChangeInstallationDirectory": true,
      "shortcutName": "RefBoard"
    }
  }
}
```

**설정 설명:**
- `target: "nsis"`: NSIS 설치 프로그램 생성
- `oneClick: false`: 설치 마법사 사용 (사용자가 설치 경로 선택 가능)
- `allowToChangeInstallationDirectory: true`: 설치 경로 변경 허용
- `shortcutName: "RefBoard"`: 바탕화면 바로가기 이름

---

## 🚀 빠른 빌드 (한 번에 실행)

```bash
cd D:\Scripts\RefBoard
npm run electron:build
```

이 명령어는 자동으로:
1. `npm run build` 실행 (React 앱 빌드)
2. `electron-builder` 실행 (Windows 설치 파일 생성)

---

## 📁 빌드 결과물

빌드가 완료되면 `release/` 폴더에 다음 파일들이 생성됩니다:

```
release/
├── RefBoard Setup 0.0.0.exe  ← 설치 파일 (이것을 배포!)
├── RefBoard Setup 0.0.0.exe.blockmap
└── latest.yml (자동 업데이트용)
```

**배포할 파일:**
- `RefBoard Setup 0.0.0.exe` - 이것을 사용자에게 배포합니다

---

## ⚠️ 중요: 프로덕션 모드 설정 확인

현재 `electron/main.js`에서 프로덕션 모드일 때 웹 앱을 로드하고 있습니다:

```javascript
// 프로덕션 모드
mainWindow.loadURL('https://refboard-21681.web.app');
```

### 옵션 1: 로컬 파일 로드 (권장)

로컬에 빌드된 파일을 로드하도록 변경:

```javascript
// 프로덕션 모드
const path = require('path');
const isDev = process.env.NODE_ENV === 'development';

if (isDev) {
    mainWindow.loadURL('http://localhost:5173');
} else {
    // 로컬 파일 로드
    mainWindow.loadFile(path.join(__dirname, '../dist/index.html'));
}
```

### 옵션 2: 웹 앱 URL 유지

현재 설정대로 웹 앱을 로드하려면 그대로 두면 됩니다.
(인터넷 연결이 필요함)

---

## 🔧 빌드 옵션 커스터마이징

### 아이콘 추가

1. `build/` 폴더 생성
2. 아이콘 파일 추가:
   - `build/icon.ico` (Windows용)
   - `build/icon.png` (다른 플랫폼용)

3. `package.json`에 추가:
```json
{
  "build": {
    "win": {
      "icon": "build/icon.ico"
    }
  }
}
```

### 설치 파일 이름 변경

`package.json`에서:
```json
{
  "build": {
    "productName": "RefBoard",
    "artifactName": "${productName} Setup ${version}.${ext}"
  }
}
```

### 버전 번호 설정

`package.json`에서:
```json
{
  "version": "1.0.0"
}
```

---

## 🐛 문제 해결

### 빌드가 실패하는 경우

1. **의존성 재설치**
   ```bash
   npm install
   ```

2. **캐시 삭제**
   ```bash
   npm run build -- --force
   ```

3. **electron-builder 캐시 삭제**
   ```bash
   npx electron-builder install-app-deps
   ```

### 빌드는 성공했지만 앱이 실행되지 않는 경우

1. **개발 모드로 테스트**
   ```bash
   npm run electron:dev
   ```

2. **콘솔 로그 확인**
   - 개발 모드에서 DevTools가 열립니다
   - 에러 메시지 확인

3. **파일 경로 확인**
   - `dist/index.html` 파일이 있는지 확인
   - `electron/main.js`의 파일 경로 확인

### 설치 파일이 생성되지 않는 경우

1. **출력 폴더 확인**
   - `release/` 폴더가 생성되었는지 확인
   - 관리자 권한이 필요한지 확인

2. **빌드 로그 확인**
   - 빌드 중 에러 메시지 확인
   - 전체 로그를 파일로 저장:
     ```bash
     npm run electron:build > build.log 2>&1
     ```

---

## 📝 빌드 체크리스트

빌드 전 확인:
- [ ] `npm install` 실행 완료
- [ ] `package.json`의 빌드 설정 확인
- [ ] `electron/main.js`의 프로덕션 모드 설정 확인
- [ ] 필요한 파일들이 모두 있는지 확인

빌드 실행:
- [ ] `npm run build` 실행 (또는 `npm run electron:build`)
- [ ] 빌드가 성공적으로 완료되었는지 확인
- [ ] `release/` 폴더에 설치 파일이 생성되었는지 확인

빌드 후 테스트:
- [ ] 생성된 `.exe` 파일 실행
- [ ] 설치 프로세스 테스트
- [ ] 설치된 앱 실행 테스트
- [ ] 주요 기능 테스트

---

## 🎉 완료!

빌드가 성공하면 `release/RefBoard Setup 0.0.0.exe` 파일이 생성됩니다.

이 파일을 사용자에게 배포하면 됩니다!

---

## 📦 배포 방법

### 1. 직접 배포
- 파일을 클라우드 스토리지(Google Drive, Dropbox 등)에 업로드
- 다운로드 링크 공유

### 2. 웹사이트에 업로드
- 자신의 웹사이트에 다운로드 페이지 생성
- 파일 업로드 및 다운로드 링크 제공

### 3. GitHub Releases 사용
- GitHub 리포지토리의 Releases 섹션에 업로드
- 버전 태그와 함께 배포

---

## 🔄 자동 업데이트 설정 (선택사항)

자동 업데이트를 설정하려면:
- `electron-updater` 패키지 사용
- 업데이트 서버 설정 (GitHub Releases, S3 등)

자세한 내용은 electron-builder 문서를 참조하세요.




