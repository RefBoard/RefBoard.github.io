let l=null;function a(){if(!document.getElementById("gis-script")){const e=document.createElement("script");e.id="gis-script",e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,document.head.appendChild(e)}}async function u(e){return new Promise((s,o)=>{let c;const n=setInterval(()=>{var r,i;(i=(r=window.google)==null?void 0:r.accounts)!=null&&i.oauth2&&(clearInterval(n),clearTimeout(c),l=window.google.accounts.oauth2.initTokenClient({client_id:e,scope:"https://www.googleapis.com/auth/drive",callback:t=>{if(t.error){console.error("GIS error:",t),o(new Error(t.error));return}localStorage.setItem("google_access_token",t.access_token),console.log("âœ… Drive access token obtained via GIS"),s(t.access_token)}}),l.requestAccessToken())},100);c=setTimeout(()=>{clearInterval(n),o(new Error("GIS failed to load"))},1e4)})}export{a as initGoogleIdentityServices,u as requestDriveAccess};
